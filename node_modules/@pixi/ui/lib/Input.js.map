{"version":3,"file":"Input.js","sources":["../src/Input.ts"],"sourcesContent":["import { Texture, utils, Ticker } from '@pixi/core';\nimport { Container } from '@pixi/display';\nimport { Graphics } from '@pixi/graphics';\nimport { Sprite } from '@pixi/sprite';\nimport { TextStyle, Text } from '@pixi/text';\nimport { Signal } from 'typed-signals';\nimport { getView } from './utils/helpers/view';\nimport { Padding } from './utils/HelpTypes';\n\nexport type InputOptions = {\n    bg?: Container | string;\n    textStyle?: Partial<TextStyle>;\n    placeholder?: string;\n    value?: string;\n    maxLength?: number;\n    align?: 'left' | 'center' | 'right';\n    padding?: Padding;\n};\n\n/**\n * Container-based component that creates an input to read the user's text.\n * @example\n * new Input({\n *     bg: Sprite.from('input.png'),\n *     placeholder: 'Enter text',\n *     padding: {\n *      top: 11,\n *      right: 11,\n *      bottom: 11,\n *      left: 11\n *     } // alternatively you can use [11, 11, 11, 11] or [11, 11] or just 11\n * });\n */\nexport class Input extends Container\n{\n    protected _bg?: Container;\n    protected _cursor: Sprite;\n    protected inputMask: Graphics;\n    protected inputField: Text;\n    protected placeholder: Text;\n    protected editing = false;\n    protected tick = 0;\n\n    protected activation = false;\n    protected readonly options: InputOptions;\n\n    /** Fires when input loses focus. */\n    onEnter: Signal<(text: string) => void>;\n\n    /** Fires every time input string is changed. */\n    onChange: Signal<(text: string) => void>;\n\n    /** Top side padding */\n    paddingTop = 0;\n\n    /** Right side padding */\n    paddingRight = 0;\n\n    /** Bottom side padding */\n    paddingBottom = 0;\n\n    /** Left side padding */\n    paddingLeft = 0;\n\n    constructor(options: InputOptions)\n    {\n        super();\n\n        this.options = options;\n        this.padding = options.padding;\n\n        this.cursor = 'text';\n        this.interactive = true;\n\n        this.on('pointertap', () => (this.activation = true));\n\n        if (utils.isMobile.any)\n        {\n            window.addEventListener('touchstart', () => this.handleActivation());\n\n            let keyboard = document.getElementById('v-keyboard') as HTMLInputElement;\n\n            if (!keyboard)\n            {\n                keyboard = document.createElement('input');\n\n                document.body.appendChild(keyboard);\n                keyboard.setAttribute('id', 'v-keyboard');\n\n                keyboard.style.opacity = '0';\n            }\n\n            keyboard.oninput = () =>\n            {\n                let value = keyboard.value;\n\n                const maxLength = this.options.maxLength;\n\n                if (maxLength && value.length > this.options.maxLength)\n                {\n                    value = value.substring(0, maxLength);\n                    keyboard.value = value;\n                }\n\n                this.value = value;\n\n                this.onChange.emit(this.value);\n            };\n        }\n        else\n        {\n            window.addEventListener('click', () =>\n            {\n                this.handleActivation();\n            });\n\n            window.addEventListener('keydown', (e) =>\n            {\n                const key = e.key;\n\n                if (key === 'Backspace')\n                {\n                    this._delete();\n                }\n                else if (key === 'Escape' || key === 'Enter')\n                {\n                    this.stopEditing();\n                }\n                else if (key.length === 1) this._add(key);\n            });\n        }\n\n        this.onEnter = new Signal();\n        this.onChange = new Signal();\n\n        Ticker.shared.add((delta) => this.update(delta));\n\n        if (options.bg)\n        {\n            this.bg = options.bg;\n        }\n        else\n        {\n            console.error('Input: bg is not defined, please define it.');\n        }\n    }\n\n    protected init()\n    {\n        const options = this.options;\n\n        const defaultTextStyle = {\n            fill: 0x000000,\n            align: 'center'\n        } as TextStyle;\n\n        const textStyle = new TextStyle(options.textStyle ?? defaultTextStyle);\n\n        this.inputField = new Text('', textStyle);\n\n        this._cursor = new Sprite(Texture.WHITE);\n        this._cursor.tint = Number(options.textStyle.fill) || 0x000000;\n        this._cursor.anchor.set(0.5);\n        this._cursor.width = 2;\n        this._cursor.height = this.inputField.height * 0.8;\n        this._cursor.alpha = 0;\n\n        this.placeholder = new Text(options.placeholder, textStyle ?? defaultTextStyle);\n        this.placeholder.visible = !!options.placeholder;\n\n        this.addChild(this.inputField, this.placeholder, this._cursor);\n\n        this.value = options.value ?? '';\n\n        this.align();\n    }\n\n    set bg(bg: Container | string)\n    {\n        this._bg = getView(bg);\n        this._bg.cursor = 'text';\n        this._bg.interactive = true;\n\n        if (!this._bg.parent)\n        {\n            this.addChild(this._bg);\n        }\n\n        if (!this.inputField)\n        {\n            this.init();\n        }\n\n        this.inputMask = new Graphics()\n            .beginFill(0xffffff)\n            .drawRect(\n                this.paddingLeft,\n                this.paddingTop,\n                this._bg.width - this.paddingRight - this.paddingLeft,\n                this._bg.height - this.paddingBottom - this.paddingTop\n            );\n\n        this.inputField.mask = this.inputMask;\n\n        this._cursor.mask = this.inputMask;\n\n        if (!this.inputMask.parent)\n        {\n            this.addChild(this.inputMask);\n        }\n    }\n\n    get bg(): Container | string\n    {\n        return this._bg;\n    }\n\n    protected _add(key: string): void\n    {\n        if (!this.editing)\n        {\n            return;\n        }\n\n        if (this.options.maxLength && this.value.length >= this.options.maxLength)\n        {\n            return;\n        }\n\n        this.value = this.value + key;\n\n        this.onChange.emit(this.value);\n    }\n\n    protected _delete(): void\n    {\n        if (!this.editing || this.value.length === 0) return;\n        const array = this.value.split('');\n\n        array.pop();\n        this.value = array.join('');\n\n        this.onChange.emit(this.value);\n    }\n\n    protected _startEditing(): void\n    {\n        this.tick = 0;\n        this.editing = true;\n        this.placeholder.visible = false;\n        this._cursor.alpha = 1;\n\n        if (utils.isMobile.any)\n        {\n            const keyboard = document.getElementById('v-keyboard') as HTMLInputElement;\n\n            keyboard.focus();\n            keyboard.click();\n            keyboard.value = this.value;\n        }\n\n        this.align();\n    }\n\n    protected handleActivation()\n    {\n        this.stopEditing();\n\n        if (this.activation)\n        {\n            this._startEditing();\n\n            this.activation = false;\n        }\n    }\n\n    protected stopEditing(): void\n    {\n        if (!this.editing) return;\n\n        this._cursor.alpha = 0;\n        this.editing = false;\n\n        if (this.inputField.text === '')\n        {\n            this.placeholder.visible = true;\n        }\n\n        if (this.value.length === 0) this.placeholder.visible = true;\n        if (utils.isMobile.any) document.getElementById('v-keyboard')?.blur();\n\n        this.align();\n\n        this.onEnter.emit(this.value);\n    }\n\n    protected update(dt: number): void\n    {\n        if (!this.editing) return;\n        this.tick += dt * 0.1;\n        this._cursor.alpha = Math.round((Math.sin(this.tick) * 0.5) + 0.5);\n    }\n\n    protected align()\n    {\n        if (!this._bg) return;\n\n        const align = this.getAlign();\n\n        this.inputField.anchor.set(align, 0.5);\n        this.inputField.x = (this._bg.width * align) + (align === 1 ? -this.paddingRight : this.paddingLeft);\n        this.inputField.y = (this._bg.height / 2) + this.paddingTop - this.paddingBottom;\n\n        this.placeholder.anchor.set(align, 0.5);\n        this.placeholder.x = (this._bg.width * align) + (align === 1 ? -this.paddingRight : this.paddingLeft);\n        this.placeholder.y = this._bg.height / 2;\n\n        this._cursor.x = this.getCursorPosX();\n        this._cursor.y = this.inputField.y;\n    }\n\n    protected getAlign(): 0 | 1 | 0.5\n    {\n        const maxWidth = this._bg.width * 0.95;\n        const paddings = this.paddingLeft + this.paddingRight - 10;\n        const isOverflowed = this.inputField.width + paddings > maxWidth;\n\n        if (isOverflowed)\n        {\n            return this.editing ? 1 : 0;\n        }\n        switch (this.options.align)\n        {\n            case 'left':\n                return 0;\n            case 'center':\n                return 0.5;\n            case 'right':\n                return 1;\n            default:\n                return 0;\n        }\n    }\n\n    protected getCursorPosX()\n    {\n        const align = this.getAlign();\n\n        switch (align)\n        {\n            case 0:\n                return this.inputField.x + this.inputField.width;\n            case 0.5:\n                return this.inputField.x + (this.inputField.width * 0.5);\n            case 1:\n                return this.inputField.x;\n            default:\n                return 0;\n        }\n    }\n\n    /** Sets the input text. */\n    set value(text: string)\n    {\n        this.inputField.text = text;\n\n        if (text.length !== 0)\n        {\n            this.placeholder.visible = false;\n        }\n        else\n        {\n            this.placeholder.visible = !this.editing;\n        }\n\n        this.align();\n    }\n\n    /** Return text of the input. */\n    get value(): string\n    {\n        return this.inputField.text;\n    }\n\n    /**\n     * Set paddings\n     * @param value - number, array of 4 numbers or object with keys: top, right, bottom, left\n     * or: [top, right, bottom, left]\n     * or: [top&bottom, right&left]\n     * or: {\n     *  left: 10,\n     *  right: 10,\n     *  top: 10,\n     *  bottom: 10,\n     * }\n     */\n    set padding(value: Padding)\n    {\n        if (typeof value === 'number')\n        {\n            this.paddingTop = value;\n            this.paddingRight = value;\n            this.paddingBottom = value;\n            this.paddingLeft = value;\n        }\n\n        if (Array.isArray(value))\n        {\n            this.paddingTop = value[0] ?? 0;\n            this.paddingRight = value[1] ?? value[0] ?? 0;\n            this.paddingBottom = value[2] ?? value[0] ?? 0;\n            this.paddingLeft = value[3] ?? value[1] ?? value[0] ?? 0;\n        }\n        else if (typeof value === 'object')\n        {\n            this.paddingTop = value.top ?? 0;\n            this.paddingRight = value.right ?? 0;\n            this.paddingBottom = value.bottom ?? 0;\n            this.paddingLeft = value.left ?? 0;\n        }\n    }\n\n    // Return array of paddings [top, right, bottom, left]\n    get padding(): [number, number, number, number]\n    {\n        return [this.paddingTop, this.paddingRight, this.paddingBottom, this.paddingLeft];\n    }\n}\n"],"names":["Container","utils","Signal","Ticker","TextStyle","Text","Sprite","Texture","getView","Graphics"],"mappings":";;;;;;;;;;AAiCO,MAAM,cAAcA,iBAC3B,CAAA;AAAA,EA8BI,YAAY,OACZ,EAAA;AACI,IAAM,KAAA,EAAA,CAAA;AA1BV,IAAA,IAAA,CAAU,OAAU,GAAA,KAAA,CAAA;AACpB,IAAA,IAAA,CAAU,IAAO,GAAA,CAAA,CAAA;AAEjB,IAAA,IAAA,CAAU,UAAa,GAAA,KAAA,CAAA;AAUvB;AAAA,IAAa,IAAA,CAAA,UAAA,GAAA,CAAA,CAAA;AAGb;AAAA,IAAe,IAAA,CAAA,YAAA,GAAA,CAAA,CAAA;AAGf;AAAA,IAAgB,IAAA,CAAA,aAAA,GAAA,CAAA,CAAA;AAGhB;AAAA,IAAc,IAAA,CAAA,WAAA,GAAA,CAAA,CAAA;AAMV,IAAA,IAAA,CAAK,OAAU,GAAA,OAAA,CAAA;AACf,IAAA,IAAA,CAAK,UAAU,OAAQ,CAAA,OAAA,CAAA;AAEvB,IAAA,IAAA,CAAK,MAAS,GAAA,MAAA,CAAA;AACd,IAAA,IAAA,CAAK,WAAc,GAAA,IAAA,CAAA;AAEnB,IAAA,IAAA,CAAK,EAAG,CAAA,YAAA,EAAc,MAAO,IAAA,CAAK,aAAa,IAAK,CAAA,CAAA;AAEpD,IAAI,IAAAC,UAAA,CAAM,SAAS,GACnB,EAAA;AACI,MAAA,MAAA,CAAO,gBAAiB,CAAA,YAAA,EAAc,MAAM,IAAA,CAAK,kBAAkB,CAAA,CAAA;AAEnE,MAAI,IAAA,QAAA,GAAW,QAAS,CAAA,cAAA,CAAe,YAAY,CAAA,CAAA;AAEnD,MAAA,IAAI,CAAC,QACL,EAAA;AACI,QAAW,QAAA,GAAA,QAAA,CAAS,cAAc,OAAO,CAAA,CAAA;AAEzC,QAAS,QAAA,CAAA,IAAA,CAAK,YAAY,QAAQ,CAAA,CAAA;AAClC,QAAS,QAAA,CAAA,YAAA,CAAa,MAAM,YAAY,CAAA,CAAA;AAExC,QAAA,QAAA,CAAS,MAAM,OAAU,GAAA,GAAA,CAAA;AAAA,OAC7B;AAEA,MAAA,QAAA,CAAS,UAAU,MACnB;AACI,QAAA,IAAI,QAAQ,QAAS,CAAA,KAAA,CAAA;AAErB,QAAM,MAAA,SAAA,GAAY,KAAK,OAAQ,CAAA,SAAA,CAAA;AAE/B,QAAA,IAAI,SAAa,IAAA,KAAA,CAAM,MAAS,GAAA,IAAA,CAAK,QAAQ,SAC7C,EAAA;AACI,UAAQ,KAAA,GAAA,KAAA,CAAM,SAAU,CAAA,CAAA,EAAG,SAAS,CAAA,CAAA;AACpC,UAAA,QAAA,CAAS,KAAQ,GAAA,KAAA,CAAA;AAAA,SACrB;AAEA,QAAA,IAAA,CAAK,KAAQ,GAAA,KAAA,CAAA;AAEb,QAAK,IAAA,CAAA,QAAA,CAAS,IAAK,CAAA,IAAA,CAAK,KAAK,CAAA,CAAA;AAAA,OACjC,CAAA;AAAA,KAGJ,MAAA;AACI,MAAO,MAAA,CAAA,gBAAA,CAAiB,SAAS,MACjC;AACI,QAAA,IAAA,CAAK,gBAAiB,EAAA,CAAA;AAAA,OACzB,CAAA,CAAA;AAED,MAAO,MAAA,CAAA,gBAAA,CAAiB,SAAW,EAAA,CAAC,CACpC,KAAA;AACI,QAAA,MAAM,MAAM,CAAE,CAAA,GAAA,CAAA;AAEd,QAAA,IAAI,QAAQ,WACZ,EAAA;AACI,UAAA,IAAA,CAAK,OAAQ,EAAA,CAAA;AAAA,SAER,MAAA,IAAA,GAAA,KAAQ,QAAY,IAAA,GAAA,KAAQ,OACrC,EAAA;AACI,UAAA,IAAA,CAAK,WAAY,EAAA,CAAA;AAAA,SACrB,MAAA,IACS,IAAI,MAAW,KAAA,CAAA;AAAG,UAAA,IAAA,CAAK,KAAK,GAAG,CAAA,CAAA;AAAA,OAC3C,CAAA,CAAA;AAAA,KACL;AAEA,IAAK,IAAA,CAAA,OAAA,GAAU,IAAIC,mBAAO,EAAA,CAAA;AAC1B,IAAK,IAAA,CAAA,QAAA,GAAW,IAAIA,mBAAO,EAAA,CAAA;AAE3B,IAAAC,WAAA,CAAO,OAAO,GAAI,CAAA,CAAC,UAAU,IAAK,CAAA,MAAA,CAAO,KAAK,CAAC,CAAA,CAAA;AAE/C,IAAA,IAAI,QAAQ,EACZ,EAAA;AACI,MAAA,IAAA,CAAK,KAAK,OAAQ,CAAA,EAAA,CAAA;AAAA,KAGtB,MAAA;AACI,MAAA,OAAA,CAAQ,MAAM,6CAA6C,CAAA,CAAA;AAAA,KAC/D;AAAA,GACJ;AAAA,EAEU,IACV,GAAA;AACI,IAAA,MAAM,UAAU,IAAK,CAAA,OAAA,CAAA;AAErB,IAAA,MAAM,gBAAmB,GAAA;AAAA,MACrB,IAAM,EAAA,CAAA;AAAA,MACN,KAAO,EAAA,QAAA;AAAA,KACX,CAAA;AAEA,IAAA,MAAM,SAAY,GAAA,IAAIC,cAAU,CAAA,OAAA,CAAQ,aAAa,gBAAgB,CAAA,CAAA;AAErE,IAAA,IAAA,CAAK,UAAa,GAAA,IAAIC,SAAK,CAAA,EAAA,EAAI,SAAS,CAAA,CAAA;AAExC,IAAA,IAAA,CAAK,OAAU,GAAA,IAAIC,aAAO,CAAAC,YAAA,CAAQ,KAAK,CAAA,CAAA;AACvC,IAAA,IAAA,CAAK,QAAQ,IAAO,GAAA,MAAA,CAAO,OAAQ,CAAA,SAAA,CAAU,IAAI,CAAK,IAAA,CAAA,CAAA;AACtD,IAAK,IAAA,CAAA,OAAA,CAAQ,MAAO,CAAA,GAAA,CAAI,GAAG,CAAA,CAAA;AAC3B,IAAA,IAAA,CAAK,QAAQ,KAAQ,GAAA,CAAA,CAAA;AACrB,IAAA,IAAA,CAAK,OAAQ,CAAA,MAAA,GAAS,IAAK,CAAA,UAAA,CAAW,MAAS,GAAA,GAAA,CAAA;AAC/C,IAAA,IAAA,CAAK,QAAQ,KAAQ,GAAA,CAAA,CAAA;AAErB,IAAA,IAAA,CAAK,cAAc,IAAIF,SAAA,CAAK,OAAQ,CAAA,WAAA,EAAa,aAAa,gBAAgB,CAAA,CAAA;AAC9E,IAAA,IAAA,CAAK,WAAY,CAAA,OAAA,GAAU,CAAC,CAAC,OAAQ,CAAA,WAAA,CAAA;AAErC,IAAA,IAAA,CAAK,SAAS,IAAK,CAAA,UAAA,EAAY,IAAK,CAAA,WAAA,EAAa,KAAK,OAAO,CAAA,CAAA;AAE7D,IAAK,IAAA,CAAA,KAAA,GAAQ,QAAQ,KAAS,IAAA,EAAA,CAAA;AAE9B,IAAA,IAAA,CAAK,KAAM,EAAA,CAAA;AAAA,GACf;AAAA,EAEA,IAAI,GAAG,EACP,EAAA;AACI,IAAK,IAAA,CAAA,GAAA,GAAMG,aAAQ,EAAE,CAAA,CAAA;AACrB,IAAA,IAAA,CAAK,IAAI,MAAS,GAAA,MAAA,CAAA;AAClB,IAAA,IAAA,CAAK,IAAI,WAAc,GAAA,IAAA,CAAA;AAEvB,IAAI,IAAA,CAAC,IAAK,CAAA,GAAA,CAAI,MACd,EAAA;AACI,MAAK,IAAA,CAAA,QAAA,CAAS,KAAK,GAAG,CAAA,CAAA;AAAA,KAC1B;AAEA,IAAI,IAAA,CAAC,KAAK,UACV,EAAA;AACI,MAAA,IAAA,CAAK,IAAK,EAAA,CAAA;AAAA,KACd;AAEA,IAAA,IAAA,CAAK,YAAY,IAAIC,iBAAA,EAChB,CAAA,SAAA,CAAU,QAAQ,CAClB,CAAA,QAAA;AAAA,MACG,IAAK,CAAA,WAAA;AAAA,MACL,IAAK,CAAA,UAAA;AAAA,MACL,IAAK,CAAA,GAAA,CAAI,KAAQ,GAAA,IAAA,CAAK,eAAe,IAAK,CAAA,WAAA;AAAA,MAC1C,IAAK,CAAA,GAAA,CAAI,MAAS,GAAA,IAAA,CAAK,gBAAgB,IAAK,CAAA,UAAA;AAAA,KAChD,CAAA;AAEJ,IAAK,IAAA,CAAA,UAAA,CAAW,OAAO,IAAK,CAAA,SAAA,CAAA;AAE5B,IAAK,IAAA,CAAA,OAAA,CAAQ,OAAO,IAAK,CAAA,SAAA,CAAA;AAEzB,IAAI,IAAA,CAAC,IAAK,CAAA,SAAA,CAAU,MACpB,EAAA;AACI,MAAK,IAAA,CAAA,QAAA,CAAS,KAAK,SAAS,CAAA,CAAA;AAAA,KAChC;AAAA,GACJ;AAAA,EAEA,IAAI,EACJ,GAAA;AACI,IAAA,OAAO,IAAK,CAAA,GAAA,CAAA;AAAA,GAChB;AAAA,EAEU,KAAK,GACf,EAAA;AACI,IAAI,IAAA,CAAC,KAAK,OACV,EAAA;AACI,MAAA,OAAA;AAAA,KACJ;AAEA,IAAI,IAAA,IAAA,CAAK,QAAQ,SAAa,IAAA,IAAA,CAAK,MAAM,MAAU,IAAA,IAAA,CAAK,QAAQ,SAChE,EAAA;AACI,MAAA,OAAA;AAAA,KACJ;AAEA,IAAK,IAAA,CAAA,KAAA,GAAQ,KAAK,KAAQ,GAAA,GAAA,CAAA;AAE1B,IAAK,IAAA,CAAA,QAAA,CAAS,IAAK,CAAA,IAAA,CAAK,KAAK,CAAA,CAAA;AAAA,GACjC;AAAA,EAEU,OACV,GAAA;AACI,IAAA,IAAI,CAAC,IAAA,CAAK,OAAW,IAAA,IAAA,CAAK,MAAM,MAAW,KAAA,CAAA;AAAG,MAAA,OAAA;AAC9C,IAAA,MAAM,KAAQ,GAAA,IAAA,CAAK,KAAM,CAAA,KAAA,CAAM,EAAE,CAAA,CAAA;AAEjC,IAAA,KAAA,CAAM,GAAI,EAAA,CAAA;AACV,IAAK,IAAA,CAAA,KAAA,GAAQ,KAAM,CAAA,IAAA,CAAK,EAAE,CAAA,CAAA;AAE1B,IAAK,IAAA,CAAA,QAAA,CAAS,IAAK,CAAA,IAAA,CAAK,KAAK,CAAA,CAAA;AAAA,GACjC;AAAA,EAEU,aACV,GAAA;AACI,IAAA,IAAA,CAAK,IAAO,GAAA,CAAA,CAAA;AACZ,IAAA,IAAA,CAAK,OAAU,GAAA,IAAA,CAAA;AACf,IAAA,IAAA,CAAK,YAAY,OAAU,GAAA,KAAA,CAAA;AAC3B,IAAA,IAAA,CAAK,QAAQ,KAAQ,GAAA,CAAA,CAAA;AAErB,IAAI,IAAAR,UAAA,CAAM,SAAS,GACnB,EAAA;AACI,MAAM,MAAA,QAAA,GAAW,QAAS,CAAA,cAAA,CAAe,YAAY,CAAA,CAAA;AAErD,MAAA,QAAA,CAAS,KAAM,EAAA,CAAA;AACf,MAAA,QAAA,CAAS,KAAM,EAAA,CAAA;AACf,MAAA,QAAA,CAAS,QAAQ,IAAK,CAAA,KAAA,CAAA;AAAA,KAC1B;AAEA,IAAA,IAAA,CAAK,KAAM,EAAA,CAAA;AAAA,GACf;AAAA,EAEU,gBACV,GAAA;AACI,IAAA,IAAA,CAAK,WAAY,EAAA,CAAA;AAEjB,IAAA,IAAI,KAAK,UACT,EAAA;AACI,MAAA,IAAA,CAAK,aAAc,EAAA,CAAA;AAEnB,MAAA,IAAA,CAAK,UAAa,GAAA,KAAA,CAAA;AAAA,KACtB;AAAA,GACJ;AAAA,EAEU,WACV,GAAA;AACI,IAAA,IAAI,CAAC,IAAK,CAAA,OAAA;AAAS,MAAA,OAAA;AAEnB,IAAA,IAAA,CAAK,QAAQ,KAAQ,GAAA,CAAA,CAAA;AACrB,IAAA,IAAA,CAAK,OAAU,GAAA,KAAA,CAAA;AAEf,IAAI,IAAA,IAAA,CAAK,UAAW,CAAA,IAAA,KAAS,EAC7B,EAAA;AACI,MAAA,IAAA,CAAK,YAAY,OAAU,GAAA,IAAA,CAAA;AAAA,KAC/B;AAEA,IAAI,IAAA,IAAA,CAAK,MAAM,MAAW,KAAA,CAAA;AAAG,MAAA,IAAA,CAAK,YAAY,OAAU,GAAA,IAAA,CAAA;AACxD,IAAA,IAAIA,WAAM,QAAS,CAAA,GAAA;AAAK,MAAS,QAAA,CAAA,cAAA,CAAe,YAAY,CAAA,EAAG,IAAK,EAAA,CAAA;AAEpE,IAAA,IAAA,CAAK,KAAM,EAAA,CAAA;AAEX,IAAK,IAAA,CAAA,OAAA,CAAQ,IAAK,CAAA,IAAA,CAAK,KAAK,CAAA,CAAA;AAAA,GAChC;AAAA,EAEU,OAAO,EACjB,EAAA;AACI,IAAA,IAAI,CAAC,IAAK,CAAA,OAAA;AAAS,MAAA,OAAA;AACnB,IAAA,IAAA,CAAK,QAAQ,EAAK,GAAA,GAAA,CAAA;AAClB,IAAK,IAAA,CAAA,OAAA,CAAQ,KAAQ,GAAA,IAAA,CAAK,KAAO,CAAA,IAAA,CAAK,IAAI,IAAK,CAAA,IAAI,CAAI,GAAA,GAAA,GAAO,GAAG,CAAA,CAAA;AAAA,GACrE;AAAA,EAEU,KACV,GAAA;AACI,IAAA,IAAI,CAAC,IAAK,CAAA,GAAA;AAAK,MAAA,OAAA;AAEf,IAAM,MAAA,KAAA,GAAQ,KAAK,QAAS,EAAA,CAAA;AAE5B,IAAA,IAAA,CAAK,UAAW,CAAA,MAAA,CAAO,GAAI,CAAA,KAAA,EAAO,GAAG,CAAA,CAAA;AACrC,IAAK,IAAA,CAAA,UAAA,CAAW,CAAK,GAAA,IAAA,CAAK,GAAI,CAAA,KAAA,GAAQ,KAAU,IAAA,KAAA,KAAU,CAAI,GAAA,CAAC,IAAK,CAAA,YAAA,GAAe,IAAK,CAAA,WAAA,CAAA,CAAA;AACxF,IAAK,IAAA,CAAA,UAAA,CAAW,IAAK,IAAK,CAAA,GAAA,CAAI,SAAS,CAAK,GAAA,IAAA,CAAK,aAAa,IAAK,CAAA,aAAA,CAAA;AAEnE,IAAA,IAAA,CAAK,WAAY,CAAA,MAAA,CAAO,GAAI,CAAA,KAAA,EAAO,GAAG,CAAA,CAAA;AACtC,IAAK,IAAA,CAAA,WAAA,CAAY,CAAK,GAAA,IAAA,CAAK,GAAI,CAAA,KAAA,GAAQ,KAAU,IAAA,KAAA,KAAU,CAAI,GAAA,CAAC,IAAK,CAAA,YAAA,GAAe,IAAK,CAAA,WAAA,CAAA,CAAA;AACzF,IAAA,IAAA,CAAK,WAAY,CAAA,CAAA,GAAI,IAAK,CAAA,GAAA,CAAI,MAAS,GAAA,CAAA,CAAA;AAEvC,IAAK,IAAA,CAAA,OAAA,CAAQ,CAAI,GAAA,IAAA,CAAK,aAAc,EAAA,CAAA;AACpC,IAAK,IAAA,CAAA,OAAA,CAAQ,CAAI,GAAA,IAAA,CAAK,UAAW,CAAA,CAAA,CAAA;AAAA,GACrC;AAAA,EAEU,QACV,GAAA;AACI,IAAM,MAAA,QAAA,GAAW,IAAK,CAAA,GAAA,CAAI,KAAQ,GAAA,IAAA,CAAA;AAClC,IAAA,MAAM,QAAW,GAAA,IAAA,CAAK,WAAc,GAAA,IAAA,CAAK,YAAe,GAAA,EAAA,CAAA;AACxD,IAAA,MAAM,YAAe,GAAA,IAAA,CAAK,UAAW,CAAA,KAAA,GAAQ,QAAW,GAAA,QAAA,CAAA;AAExD,IAAA,IAAI,YACJ,EAAA;AACI,MAAO,OAAA,IAAA,CAAK,UAAU,CAAI,GAAA,CAAA,CAAA;AAAA,KAC9B;AACA,IAAQ,QAAA,IAAA,CAAK,QAAQ,KACrB;AAAA,MACI,KAAK,MAAA;AACD,QAAO,OAAA,CAAA,CAAA;AAAA,MACX,KAAK,QAAA;AACD,QAAO,OAAA,GAAA,CAAA;AAAA,MACX,KAAK,OAAA;AACD,QAAO,OAAA,CAAA,CAAA;AAAA,MACX;AACI,QAAO,OAAA,CAAA,CAAA;AAAA,KACf;AAAA,GACJ;AAAA,EAEU,aACV,GAAA;AACI,IAAM,MAAA,KAAA,GAAQ,KAAK,QAAS,EAAA,CAAA;AAE5B,IAAA,QAAQ,KACR;AAAA,MACI,KAAK,CAAA;AACD,QAAA,OAAO,IAAK,CAAA,UAAA,CAAW,CAAI,GAAA,IAAA,CAAK,UAAW,CAAA,KAAA,CAAA;AAAA,MAC/C,KAAK,GAAA;AACD,QAAA,OAAO,IAAK,CAAA,UAAA,CAAW,CAAK,GAAA,IAAA,CAAK,WAAW,KAAQ,GAAA,GAAA,CAAA;AAAA,MACxD,KAAK,CAAA;AACD,QAAA,OAAO,KAAK,UAAW,CAAA,CAAA,CAAA;AAAA,MAC3B;AACI,QAAO,OAAA,CAAA,CAAA;AAAA,KACf;AAAA,GACJ;AAAA;AAAA,EAGA,IAAI,MAAM,IACV,EAAA;AACI,IAAA,IAAA,CAAK,WAAW,IAAO,GAAA,IAAA,CAAA;AAEvB,IAAI,IAAA,IAAA,CAAK,WAAW,CACpB,EAAA;AACI,MAAA,IAAA,CAAK,YAAY,OAAU,GAAA,KAAA,CAAA;AAAA,KAG/B,MAAA;AACI,MAAK,IAAA,CAAA,WAAA,CAAY,OAAU,GAAA,CAAC,IAAK,CAAA,OAAA,CAAA;AAAA,KACrC;AAEA,IAAA,IAAA,CAAK,KAAM,EAAA,CAAA;AAAA,GACf;AAAA;AAAA,EAGA,IAAI,KACJ,GAAA;AACI,IAAA,OAAO,KAAK,UAAW,CAAA,IAAA,CAAA;AAAA,GAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,IAAI,QAAQ,KACZ,EAAA;AACI,IAAI,IAAA,OAAO,UAAU,QACrB,EAAA;AACI,MAAA,IAAA,CAAK,UAAa,GAAA,KAAA,CAAA;AAClB,MAAA,IAAA,CAAK,YAAe,GAAA,KAAA,CAAA;AACpB,MAAA,IAAA,CAAK,aAAgB,GAAA,KAAA,CAAA;AACrB,MAAA,IAAA,CAAK,WAAc,GAAA,KAAA,CAAA;AAAA,KACvB;AAEA,IAAI,IAAA,KAAA,CAAM,OAAQ,CAAA,KAAK,CACvB,EAAA;AACI,MAAK,IAAA,CAAA,UAAA,GAAa,KAAM,CAAA,CAAC,CAAK,IAAA,CAAA,CAAA;AAC9B,MAAA,IAAA,CAAK,eAAe,KAAM,CAAA,CAAC,CAAK,IAAA,KAAA,CAAM,CAAC,CAAK,IAAA,CAAA,CAAA;AAC5C,MAAA,IAAA,CAAK,gBAAgB,KAAM,CAAA,CAAC,CAAK,IAAA,KAAA,CAAM,CAAC,CAAK,IAAA,CAAA,CAAA;AAC7C,MAAK,IAAA,CAAA,WAAA,GAAc,MAAM,CAAC,CAAA,IAAK,MAAM,CAAC,CAAA,IAAK,KAAM,CAAA,CAAC,CAAK,IAAA,CAAA,CAAA;AAAA,KAC3D,MAAA,IACS,OAAO,KAAA,KAAU,QAC1B,EAAA;AACI,MAAK,IAAA,CAAA,UAAA,GAAa,MAAM,GAAO,IAAA,CAAA,CAAA;AAC/B,MAAK,IAAA,CAAA,YAAA,GAAe,MAAM,KAAS,IAAA,CAAA,CAAA;AACnC,MAAK,IAAA,CAAA,aAAA,GAAgB,MAAM,MAAU,IAAA,CAAA,CAAA;AACrC,MAAK,IAAA,CAAA,WAAA,GAAc,MAAM,IAAQ,IAAA,CAAA,CAAA;AAAA,KACrC;AAAA,GACJ;AAAA;AAAA,EAGA,IAAI,OACJ,GAAA;AACI,IAAO,OAAA,CAAC,KAAK,UAAY,EAAA,IAAA,CAAK,cAAc,IAAK,CAAA,aAAA,EAAe,KAAK,WAAW,CAAA,CAAA;AAAA,GACpF;AACJ;;;;"}