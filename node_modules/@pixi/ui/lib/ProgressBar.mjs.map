{"version":3,"file":"ProgressBar.mjs","sources":["../src/ProgressBar.ts"],"sourcesContent":["import { Container } from '@pixi/display';\nimport { Graphics } from '@pixi/graphics';\nimport { Sprite } from '@pixi/sprite';\nimport { getView } from './utils/helpers/view';\n\ntype FillOffset = {\n    x?: number;\n    y?: number;\n};\n\nexport type ProgressBarOptions = {\n    bg: Container | string;\n    fill: Container | string;\n    progress?: number;\n    fillOffset?: FillOffset;\n};\n\n/**\n * Creates a ProgressBar.\n * @example\n * new ProgressBar({\n *     bg: 'slider_bg.png',\n *     fill: 'slider.png',\n *     progress: 50,\n * });\n */\nexport class ProgressBar extends Container\n{\n    protected bg!: Container;\n    protected fill!: Container;\n    protected fillMask!: Graphics;\n    protected progressStart = 0;\n    protected _progress = 0;\n\n    /** Container, that holds all inner views. */\n    innerView: Container;\n\n    constructor(params?: ProgressBarOptions)\n    {\n        super();\n\n        this.innerView = new Container();\n        this.addChild(this.innerView);\n\n        if (params?.bg && params?.fill)\n        {\n            this.init(params);\n        }\n    }\n\n    /**\n     * Initialize ProgressBar.\n     * @param root0\n     * @param root0.bg - Background texture.\n     * @param root0.fill - Fill texture.\n     * @param root0.fillOffset - Fill offset.\n     * @param root0.progress - Initial progress value.\n     */\n    init({ bg, fill, fillOffset, progress }: ProgressBarOptions)\n    {\n        this.setBackground(bg);\n\n        this.setFill(fill, fillOffset);\n\n        this.progress = progress;\n    }\n\n    /**\n     * Set bg.\n     * @param bg\n     */\n    setBackground(bg: Container | string)\n    {\n        if (this.bg)\n        {\n            this.innerView.removeChild(this.bg);\n        }\n\n        this.bg = getView(bg);\n        this.innerView.addChildAt(this.bg, 0);\n    }\n\n    /**\n     * Set fill.\n     * @param fill\n     * @param fillOffset\n     */\n    setFill(fill: Container | string, fillOffset?: FillOffset)\n    {\n        if (this.fill)\n        {\n            this.innerView.removeChild(this.fill);\n            this.fill.destroy();\n        }\n\n        // in case if user is trying to use same instance for bg and fill\n        if (this.bg instanceof Sprite && fill === this.bg)\n        {\n            fill = Sprite.from(this.bg.texture);\n        }\n\n        this.fill = getView(fill);\n        this.innerView.addChildAt(this.fill, 1);\n\n        const offsetX = fillOffset?.x ?? 0;\n        const offsetY = fillOffset?.y ?? 0;\n\n        this.fill.x = ((this.bg.width - this.fill.width) / 2) + offsetX;\n        this.fill.y = ((this.bg.height - this.fill.height) / 2) + offsetY;\n\n        if (!this.fillMask)\n        {\n            this.fillMask = new Graphics();\n        }\n\n        this.fill.addChild(this.fillMask);\n        this.fill.mask = this.fillMask;\n    }\n\n    protected validate(progress: number): number\n    {\n        progress = Math.round(progress);\n\n        if (progress < 0)\n        {\n            return 0;\n        }\n\n        if (progress > 100)\n        {\n            return 100;\n        }\n\n        return progress;\n    }\n\n    /** Set current progress percentage value. */\n    set progress(progress: number)\n    {\n        this._progress = this.validate(progress);\n\n        if (!this.fill) return;\n\n        const startPoint = (this.fill.width / 100) * this.progressStart;\n        const endPoint = ((this.fill.width / 100) * this._progress) - startPoint;\n\n        if (this.fillMask)\n        {\n            this.fillMask.clear().lineStyle(0).beginFill(0xffffff).drawRect(startPoint, 0, endPoint, this.fill.height);\n        }\n    }\n\n    /** Return current progress percentage value. */\n    get progress(): number\n    {\n        return this._progress;\n    }\n}\n"],"names":[],"mappings":"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"}